<html>
<body>

<table>
    <tr><td>Kopiera in underlaget h√§r:</td></tr>
    <tr>
        <td colspan="3">
            <textarea id="inputTextToSave" cols="80" rows="25"></textarea>
        </td>
    </tr>
    <tr>
        <td>Spara textfil som:</td>
        <td><input id="inputFileNameToSaveAs"></input></td>
        <td><button onclick="saveTextAsFile()">Spara postnumren till textfil</button></td>
    </tr>
</table>

<script type="text/javascript">



function saveTextAsFile()
{
    var text = "X" + document.getElementById("inputTextToSave").value + "X";
    var textLength = text.length;
    var zipCodes = new String();
    var i;
    for(i=6;i<=textLength;i++){
      var sixZip = text.substring((i-6),i);
      if(sixZip.charAt(3)==' ' && isNaN(parseInt(text.charAt(i)))){
        var fiveZip = sixZip.substring(0,3) + sixZip.substring(4);
      }
      else if(isNaN(parseInt(sixZip.charAt(5)))){
        var fiveZip = sixZip.substring(0,5)
      }
      if(!isNaN(fiveZip) &&
         !fiveZip.includes(' ')      &&
         !zipCodes.includes(fiveZip) &&
         isNaN(parseInt(text.charAt(i-7)))){
        var zipCodes = zipCodes.concat(fiveZip+"\r\n");
      }
    }

    var textToSaveAsBlob = new Blob([zipCodes], {type:"text/plain"});
    var textToSaveAsURL = window.URL.createObjectURL(textToSaveAsBlob);
    var fileNameToSaveAs = document.getElementById("inputFileNameToSaveAs").value;

    var downloadLink = document.createElement("a");
    downloadLink.download = fileNameToSaveAs;
    downloadLink.innerHTML = "Download File";
    downloadLink.href = textToSaveAsURL;
    downloadLink.onclick = destroyClickedElement;
    downloadLink.style.display = "none";
    document.body.appendChild(downloadLink);

    downloadLink.click();
}

function destroyClickedElement(event)
{
    document.body.removeChild(event.target);
}

</script>

</body>
</html>
